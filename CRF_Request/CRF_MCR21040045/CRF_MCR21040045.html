<html>
<head>
<style>
table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
}
</style>

<title>
	CRF_MCR21040045
</title>

<script>

function exportTableToCSV() {
    var csv = [];
    var rows = document.querySelectorAll("table tr");
    var prefixCB = 'cb';
	var prefixDC = 'dc';
	var prefixNT = 'nt';
	var csvValue = '';
	var csvValueHeader = '';
	
	try 
	{
		for (var i = 0; i < rows.length; i++) {
			var row = [], cols = rows[i].querySelectorAll("td, th");
			
			for (var j = 0; j < cols.length; j++) 
			{
				if (i > 0)
					{
					//CONFIRMED BY
						if (j == 8)
						{
							if (document.getElementById(prefixCB + i).value.split(',').join('') == '')
							{
								csvValue+= "-" + ",";
							} else {
								csvValue+= document.getElementById(prefixCB + i).value.split(',').join('') + ",";
							}	
						} 
					//DATE CONFIRMED
						else if (j == 9)
						{
							if (document.getElementById(prefixDC + i).value.split(',').join('') == '')
							{
								csvValue+= "-" + ",";
							} else {
								csvValue+= document.getElementById(prefixDC + i).value.split(',').join('') + ",";
							}	
						} 
					//NOTES
						else if (j == 10)
						{
							if (document.getElementById(prefixNT + i).value.split(',').join('') == '')
							{
								csvValue+= "-" + "\n";
							} else {
								csvValue+= document.getElementById(prefixNT + i).value.split(',').join('') + "\n";
							}	
						} else {
						    csvValue+= cols[j].innerText + ",";
						}
					} else {
					
						if (j == 10)
						{
							csvValueHeader+= cols[j].innerText + "\n";
						} else {
							csvValueHeader+= cols[j].innerText + ",";
						}	
					}

				
			
			}	

			
							
		}
		
		csv.push(csvValueHeader + csvValue);
		
		//---------------------------------------------------------------------------------
		var blob = new Blob([csv]);

		  if (window.navigator.msSaveOrOpenBlob){
			window.navigator.msSaveBlob(blob, "CRF_MCR21040045.csv");
		  }
		  else {
			var a = window.document.createElement("a");

			a.href = window.URL.createObjectURL(blob, {
			  type: "text/plain"
			});
			a.download = "CRF_MCR21040045.csv";
			document.body.appendChild(a);
			a.click();
			document.body.removeChild(a);

		}
		//---------------------------------------------------------------------------------
	}
	catch(err) {
		alert(err.message);
	}
}

</script>

</head>
<body>

<p style="height: 21px; font-size:20px;"><b>CTRLNo.: </b>CRF_MCR21040045</p>
<p style="height: 21px; font-size:20px;"><b>ATTENTION: </b>MR BASTI BASTUGA</p>
<p style="height: 21px; font-size:20px;"><b>DIVISION: </b>PURCHASING DIVISION</p>
<p style="height: 21px; font-size:20px;"><b>DEPARTMENT/PROCESS: </b>PURCHASING DEPARTMENT</p>
<p style="height: 21px; font-size:20px;"><b>SUPPLIER:</b>FERDZTECH SOLUTION FRAMEWORK</p>

<p><table style='width:100%;'><tr><th>REFID</th><th>PONO</th><th>PRNO</th><th>DESCRIPTION</th><th>TYPE/DRAWING</th><th>QUANTITY</th><th>UNIT OF MEASURE</th><th>REASON</th><th>CONFIRMED BY</th><th>DATE CONFIRMED</th><th>NOTES</th></tr><tr><td>30055</td><td>2</td><td>prno2</td><td>ITEM2</td><td>SPECS2</td><td>200.00</td><td>PCS</td><td>CHANGE MAKER</td><td><input type='text' id='cb1' name='cb1'></td><td><input type='text' id='dc1' name='dc1'></td><td><input type='text' id='nt1' name='nt1'></td></tr><tr><td>30055</td><td>3</td><td>prno3</td><td>ITEM2</td><td>SPECS3</td><td>300.00</td><td>PCS</td><td>CHANGE PACKING</td><td><input type='text' id='cb2' name='cb2'></td><td><input type='text' id='dc2' name='dc2'></td><td><input type='text' id='nt2' name='nt2'></td></tr><tr><td>30055</td><td>4</td><td>prno4</td><td>ITEM3</td><td>SPECS3</td><td>400.00</td><td>PCS</td><td>CHANGE SPECIFICATION</td><td><input type='text' id='cb3' name='cb3'></td><td><input type='text' id='dc3' name='dc3'></td><td><input type='text' id='nt3' name='nt3'></td></tr><tr><td>30055</td><td>5</td><td>prno5</td><td>ITEM5</td><td>SPECS5</td><td>500.00</td><td>PCS</td><td>EXCESS ORDER</td><td><input type='text' id='cb4' name='cb4'></td><td><input type='text' id='dc4' name='dc4'></td><td><input type='text' id='nt4' name='nt4'></td></tr><tr><td>30055</td><td>6</td><td>prno6</td><td>ITEM6</td><td>SPECS6</td><td>600.00</td><td>PCS</td><td>PRICE CHANGE</td><td><input type='text' id='cb5' name='cb5'></td><td><input type='text' id='dc5' name='dc5'></td><td><input type='text' id='nt5' name='nt5'></td></tr></table></p>
<button type="button" onclick="exportTableToCSV()">Save</button>


</body>
</html>

